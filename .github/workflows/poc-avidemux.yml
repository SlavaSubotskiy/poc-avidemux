name: PoC AviDemux
on: [workflow_dispatch]
jobs:
  PoC-AviDemux:
    runs-on: ubuntu-latest  # jlesage/avidemux:v1.4.0
    container:
      image: jlesage/avidemux:v1.4.0
    steps:
      - run: echo "üéâ The job was automatically triggered by a ${{ github.event_name }} event."
      - run: echo "üêß This job is now running on a ${{ runner.os }} server hosted by GitHub!"
      - run: echo "üîé The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
      - name: Check out repository code
        uses: actions/checkout@v2
      - run: echo "üí° The ${{ github.repository }} repository has been cloned to the runner."
      - run: echo "üñ•Ô∏è The workflow is now ready to test your code on the runner."
      - name: List files in the repository
        run: |
          ls -la $GITHUB_WORKSPACE
      - run: echo "üçè This job's status is ${{ job.status }}."
      - run: apk add --update py-pip curl jq
      - run: pip install gdown
      - run: mkdir source_video
      - run: |
          GDRIVE_BEARER=`curl -d client_id=$GDRIVE_CLIENT_ID \
          -d client_secret=$GDRIVE_CLIENT_SECRET \
          -d device_code=$GDRIVE_DEVICE_CODE \
          -d grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Adevice_code https://accounts.google.com/o/oauth2/token` && \
          GDRIVE_ACCESS_TOKEN=`echo $GDRIVE_BEARER | jq -r '.access_token'`
      - run: echo $GDRIVE_ACCESS_TOKEN
#      - run: gdown --fuzzy 'https://drive.google.com/file/d/1JqJTKToAfPhMb6l4VfB7eretVuZdwHHR/view' -O ./source_video/12002-05-05-Sahasrara-Puja-Talk.mp4
#      - run: ls -la ./source_video/
